<div class="container">
  <h1>スキルで繋がるエンジニアのマッチングアプリ</h1>

  <% unless user_signed_in? %>
    <div class="nav-section">
      <p>アカウントをお持ちでない方は新規登録、既にお持ちの方はログインしてください</p>
      <div class="nav-links">
        <%= link_to "新規登録", new_user_registration_path %>
        <%= link_to "ログイン", new_user_session_path %>
      </div>
    </div>
  <% end %>

  <div class="form-section">
    <h2>フリーワード検索</h2>
    <%= form_with url: search_users_users_path, method: :get, local: true do |f| %>
      <div class="form-group">
        <%= f.label :query, "検索ワード" %>
        <%= f.text_field :query, placeholder: "名前やスキルで検索", required: false %>
      </div>
      <%= f.submit "検索", class: "btn btn-primary" %>
    <% end %>
  </div>

  <div class="form-section">
    <h2>スキルで検索</h2>
    <%= form_with url: search_skills_users_path, method: :get, local: true do |f| %>
      <div class="form-group">
        <%= f.label :skill, "スキル" %>
        <%= f.select :skill, options_for_select([["選択してください", ""]] + @skills.map { |skill| [skill, skill] }), {}, { required: false } %>
      </div>
      <%= f.submit "検索", class: "btn btn-primary" %>
    <% end %>
  </div>

  <div class="form-section">
    <h2>新しい順にユーザーを表示</h2>
    <%= form_with url: users_path, method: :get, local: true do |f| %>
      <%= f.submit "新しい順に表示", class: "btn" %>
    <% end %>
  </div>

  <% if @users.any? %>
    <h2>繋がれるユーザー</h2>
    <div class="users-grid">
      <% @users.each do |user| %>
        <div class="user-card">
          <h3 class="user-name"><%= user.name %></h3>
          <div class="user-info">
            <% if user.introduction.present? %>
              <p><strong>自己紹介:</strong> <%= user.introduction %></p>
            <% end %>
            <% if user.skills.present? %>
              <div class="user-skills">
                スキル: <%= user.skills %>
              </div>
            <% end %>
            <% if user.age.present? %>
              <p class="user-age">年齢: <%= user.age %>歳</p>
            <% end %>
          </div>
          <% if user.profile_image.attached? %>
            <div class="user-image">
              <%= image_tag user.profile_image, alt: "#{user.name}の画像" %>
            </div>
          <% elsif user.img_url.present? %>
            <div class="user-image">
              <%= image_tag user.img_url, alt: "#{user.name}の画像" %>
            </div>
          <% end %>
          <div class="user-actions">
            <%= link_to "詳細", user_path(user), class: "btn-detail" %>
            <%= link_to "メッセージを送る", new_message_path(user_id: user.id), class: "btn-message" %>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="empty-state">
      <h2>繋がれるユーザーはまだいません</h2>
    </div>
  <% end %>
</div>

